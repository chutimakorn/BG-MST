# คู่มือ Mapping ข้อมูล Excel

## ฟิลด์ที่ระบบต้องการ

| ลำดับ | ชื่อฟิลด์ในระบบ | Column ที่รองรับ (ภาษาไทย) | Column ที่รองรับ (ภาษาอังกฤษ) | จำเป็น | หมายเหตุ |
|-------|-----------------|---------------------------|------------------------------|--------|----------|
| 1 | วันที่ส่งใบเสนอ | วันที่ส่งใบเสนอ, วันที่, วันที่เสนอราคา | JOB Date, Date, Order Date | ไม่จำเป็น | รูปแบบวันที่ Excel |
| 2 | เลขที่ใบเสนอราคา | เลขที่ใบเสนอราคา, เลขที่, ใบเสนอราคา, เลขที่เอกสาร | JOB No., JOB Number, Job No, Number | **จำเป็น** | ต้องไม่ซ้ำกัน |
| 3 | กลุ่มลูกค้า | กลุ่มลูกค้า, กลุ่ม | Group | ไม่จำเป็น | G หรือ NG (default: G) |
| 4 | ชื่อผู้ขาย | ชื่อผู้ขาย/SALE, ผู้ขาย, SALE, พนักงานขาย | Sale, Sales, Salesperson | ไม่จำเป็น | ถ้าไม่มีจะสร้างให้ |
| 5 | ชื่อลูกค้า | ชื่อลูกค้า, ลูกค้า, บริษัท, ชื่อลูกค้า/Customer | Customer, Client, Company | **จำเป็น** | |
| 6 | รหัสลูกค้า | รหัสลูกค้า, รหัส | Customer Code, Code | ไม่จำเป็น | default: N/A |
| 7 | Category Model | category model, Category, ประเภท, หมวดหมู่ | Company, Category, Type | ไม่จำเป็น | ถ้าไม่มีจะสร้างให้ |
| 8 | ชื่อรุ่นรถ | ชื่อรุ่นรถ, รุ่นรถ, รุ่น, รถ | Model, Car Model, Vehicle | ไม่จำเป็น | ถ้าไม่มีจะสร้างให้ |
| 9 | สี Body | สีbody, สี body, Body, สีตัวรถ | Body, Color, Body Color | ไม่จำเป็น | ถ้าไม่มีจะสร้างให้ |
| 10 | สี Seat | สีseat, สี seat, Seat, สีเบาะ | Seats, Seat, Seat Color | ไม่จำเป็น | ถ้าไม่มีจะสร้างให้ |
| 11 | สี Canopy | สีcanopy, สี canopy, Canopy, สีหลังคา | Canopy, Canopy Color | ไม่จำเป็น | ถ้าไม่มีจะสร้างให้ |
| 12 | Option เพิ่มเติม | optionเพิ่มเติม, Option, ออฟชั่น, เพิ่มเติม | Special Option, Option, Options | ไม่จำเป็น | |
| 13 | จำนวนคัน | จำนวนคัน, จำนวน | Unit, Qty, Quantity, Amount | ไม่จำเป็น | default: 1 |
| 14 | ราคาขายรวม VAT | ราคาขายรวม vat, ราคา, ราคาต่อคัน, ราคาขาย | Price (includ vat 7%), Price per car, Price, Total | ไม่จำเป็น | default: 0 |
| 15 | หมายเหตุสำหรับขาย | หมายเหตุสำหรับขาย, หมายเหตุ | Remark, Note, Comment | ไม่จำเป็น | |
| 16 | จังหวัด | จังหวัด | Province | ไม่จำเป็น | ถ้าไม่มีจะสร้างให้ |
| 17 | จำนวนเที่ยวขนส่ง | จำนวนเที่ยวในการขนส่ง, เที่ยวขนส่ง, จำนวนเที่ยว | - | ไม่จำเป็น | default: 0 |
| 18 | ราคาต่อเที่ยว | ราคาต่อเที่ยวในการขนส่ง, ราคาต่อเที่ยว, ค่าขนส่ง | - | ไม่จำเป็น | default: 0 |
| 19 | สถานะการขาย | ผลการพิจรณา/Status, สถานะ, ผลการพิจารณา | Status, State | ไม่จำเป็น | ถ้าไม่มีจะใช้ "อยู่ระหว่างการพิจารณา" |
| 20 | Status Job Document | - | - | ไม่จำเป็น | |
| 21 | วันส่งรถ | วันส่งรถ, วันส่ง | Delivery Date, Delivery | ไม่จำเป็น | รูปแบบวันที่ Excel |
| 22 | Status Job | status job, Status Job, สถานะงาน | Status, Job Status | ไม่จำเป็น | ถ้าไม่มีจะใช้ "อยู่ระหว่างดำเนินการ" |

## ตัวอย่างไฟล์ Excel ที่ถูกต้อง

### แบบภาษาไทย (ไฟล์ที่ 1)
```
| วันที่ส่งใบเสนอ | เลขที่ใบเสนอราคา | กลุ่มลูกค้า | ชื่อผู้ขาย/SALE | ชื่อลูกค้า | รหัสลูกค้า | category model | ชื่อรุ่นรถ | สีbody | สีseat | สีcanopy | จำนวนคัน | ราคาขายรวม vat |
|-----------------|------------------|-------------|----------------|-----------|-----------|---------------|-----------|--------|--------|----------|------------|-----------------|
| 20-ม.ค.-68     | 37PO48-16800000  | NG          | คุณกนกวรรณ     | บริษัท ABC | CUST001   | Fomm Marshell | MS2 2 ที่นั่ง | Blue   | Black  | White    | 2          | 220,000.00      |
```

### แบบภาษาอังกฤษ (ไฟล์ที่ 2)
```
| Status    | JOB Date  | JOB No.          | Sale       | Customer    | Model           | Body  | Seats | Canopy | Unit | Price per car |
|-----------|-----------|------------------|------------|-------------|-----------------|-------|-------|--------|------|---------------|
| Complete  | 17 ม.ค. 65 | SAJOBS-16800000  | คุณกนกวรรณ | บริษัท ABC  | USED FOMM One   | Blue  | Black | White  | 1    | 128,500       |
```

## หมายเหตุสำคัญ

1. **ฟิลด์ที่จำเป็นต้องมี:**
   - เลขที่ใบเสนอราคา (ต้องไม่ซ้ำกัน)
   - ชื่อลูกค้า

2. **การจัดการข้อมูลซ้ำ:**
   - ถ้าเลขที่ใบเสนอราคาซ้ำ จะข้ามแถวนั้นไป
   - ถ้าไม่มีเลขที่ใบเสนอราคา ระบบจะสร้างให้อัตโนมัติ (AUTO-timestamp-rowNumber)

3. **Master Data:**
   - ถ้าข้อมูล (ผู้ขาย, รถ, สี, จังหวัด) ยังไม่มีในระบบ จะสร้างให้อัตโนมัติ

4. **รูปแบบวันที่:**
   - รองรับรูปแบบวันที่ของ Excel ทุกแบบ
   - รองรับทั้งวันที่เป็นตัวเลข (Excel date number) และข้อความ

5. **ตัวเลข:**
   - รองรับตัวเลขที่มี comma (220,000.00)
   - จะแปลงเป็นตัวเลขอัตโนมัติ

6. **การคำนวณอัตโนมัติ:**
   - ยอดรวมราคาขาย = จำนวนคัน × ราคาต่อคัน
   - รวมค่าขนส่ง = จำนวนเที่ยว × ราคาต่อเที่ยว
   - ยอดรวมทั้งหมด = ยอดรวมราคาขาย + รวมค่าขนส่ง

## วิธีตรวจสอบว่าไฟล์ของคุณจะ Import ได้หรือไม่

1. เปิดไฟล์ Excel
2. ตรวจสอบว่ามี column "เลขที่ใบเสนอราคา" หรือ "JOB No." หรือไม่
3. ตรวจสอบว่ามี column "ชื่อลูกค้า" หรือ "Customer" หรือไม่
4. ถ้ามีทั้ง 2 column = พร้อม Import ✅
5. ถ้าไม่มี = ต้องเพิ่ม column หรือเปลี่ยนชื่อ column ให้ตรง ❌

## ตัวอย่าง Error และวิธีแก้

### Error: "ไม่พบเลขที่ใบเสนอราคา"
**สาเหตุ:** ไม่มี column ที่ชื่อตรงกับที่ระบบรองรับ
**วิธีแก้:** เปลี่ยนชื่อ column เป็น "เลขที่ใบเสนอราคา" หรือ "JOB No."

### Error: "ไม่พบชื่อลูกค้า"
**สาเหตุ:** ไม่มี column ชื่อลูกค้า หรือ cell ว่างเปล่า
**วิธีแก้:** เปลี่ยนชื่อ column เป็น "ชื่อลูกค้า" หรือ "Customer" และกรอกข้อมูล

### Error: "เลขที่ใบเสนอราคา XXX มีอยู่ในระบบแล้ว"
**สาเหตุ:** มีข้อมูลซ้ำในระบบ
**วิธีแก้:** เปลี่ยนเลขที่ใบเสนอราคาให้ไม่ซ้ำ หรือลบข้อมูลเก่าออกก่อน

## ต้องการความช่วยเหลือ?

ถ้ายังไม่แน่ใจว่าไฟล์ของคุณจะ Import ได้หรือไม่:
1. ไปที่หน้า Import
2. เลือกไฟล์
3. ดูที่ส่วน "ตัวอย่างข้อมูล" 
4. ระบบจะบอกว่าเป็น "ภาษาไทย" หรือ "ภาษาอังกฤษ"
5. ถ้าขึ้น "ไม่ทราบ" = ชื่อ column ไม่ตรง ต้องแก้ไข
